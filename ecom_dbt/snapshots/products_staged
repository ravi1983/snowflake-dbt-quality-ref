{% snapshot products_staged %}

{{
    config(
      target_schema = 'STAGING',
      unique_key = 'product_id',
      strategy = 'check',
      check_cols = ['PRODUCT_NAME', 'PRODUCT_CATEGORY', 'PRODUCT_BRAND', 'PRICE'],
      invalidate_hard_deletes = True
    )
}}

WITH RAW_PRODUCTS_STREAM AS (
    SELECT * FROM {{ ref('transformed_products') }}
)
SELECT
    *
FROM RAW_PRODUCTS_STREAM

{% endsnapshot %}